CREATE TABLE attending_status_type (attending_status_type_id INT AUTO_INCREMENT, display_text VARCHAR(45), created_at DATETIME, updated_at DATETIME, PRIMARY KEY(attending_status_type_id)) ENGINE = INNODB;
CREATE TABLE carpools (carpool_id INT AUTO_INCREMENT, route_id INT NOT NULL, vehicle_id INT NOT NULL, start_date DATE, start_time TIME, description TEXT, created_at DATETIME, updated_at DATETIME, INDEX route_id_idx (route_id), INDEX vehicle_id_idx (vehicle_id), PRIMARY KEY(carpool_id)) ENGINE = INNODB;
CREATE TABLE comments (comment_id INT AUTO_INCREMENT, event_id INT NOT NULL, person_id INT NOT NULL, comment TEXT NOT NULL, created_at DATETIME, updated_at DATETIME, INDEX event_id_idx (event_id), INDEX person_id_idx (person_id), PRIMARY KEY(comment_id)) ENGINE = INNODB;
CREATE TABLE conversation_participants (conversation_id INT, person_id INT, unread TINYINT DEFAULT '0' NOT NULL, created_at DATETIME, updated_at DATETIME, PRIMARY KEY(conversation_id, person_id)) ENGINE = INNODB;
CREATE TABLE conversations (conversation_id INT AUTO_INCREMENT, author_id INT NOT NULL, subject VARCHAR(255), created_at DATETIME, updated_at DATETIME, INDEX author_id_idx (author_id), PRIMARY KEY(conversation_id)) ENGINE = INNODB;
CREATE TABLE drivers (driver_id INT AUTO_INCREMENT, person_id INT NOT NULL, solo_route_id INT NOT NULL, carpool_id INT NOT NULL, seats_available INT, start_date DATE NOT NULL, start_time TIME, asking_price FLOAT(18, 2), description TEXT, created_at DATETIME, updated_at DATETIME, INDEX person_id_idx (person_id), INDEX solo_route_id_idx (solo_route_id), INDEX carpool_id_idx (carpool_id), PRIMARY KEY(driver_id)) ENGINE = INNODB;
CREATE TABLE events (event_id INT AUTO_INCREMENT, location_id INT NOT NULL, name VARCHAR(45) NOT NULL, date DATE, time TIME, picture_url_large VARCHAR(255), picture_url_small VARCHAR(255), description TEXT, website_url VARCHAR(255), certification VARCHAR(45), created_at DATETIME, updated_at DATETIME, INDEX location_id_idx (location_id), PRIMARY KEY(event_id)) ENGINE = INNODB;
CREATE TABLE friendship_requests (requestor_id INT, requestee_id INT, friendship_status_id INT NOT NULL, abuse TINYINT, abuse_comment TEXT, created_at DATETIME, updated_at DATETIME, INDEX friendship_status_id_idx (friendship_status_id), PRIMARY KEY(requestor_id, requestee_id)) ENGINE = INNODB;
CREATE TABLE friendship_statuses (friendship_status_id INT AUTO_INCREMENT, display_text VARCHAR(45), created_at DATETIME, updated_at DATETIME, PRIMARY KEY(friendship_status_id)) ENGINE = INNODB;
CREATE TABLE friendships (friend_1_id INT, friend_2_id INT, created_at DATETIME, updated_at DATETIME, PRIMARY KEY(friend_1_id, friend_2_id)) ENGINE = INNODB;
CREATE TABLE legs (leg_id INT AUTO_INCREMENT, route_id INT NOT NULL, sequence_order INT, created_at DATETIME, updated_at DATETIME, INDEX route_id_idx (route_id), PRIMARY KEY(leg_id)) ENGINE = INNODB;
CREATE TABLE locations (location_id INT AUTO_INCREMENT, step_id INT NOT NULL, name VARCHAR(255), street_1 VARCHAR(255), street _2 VARCHAR(255), city VARCHAR(45), state VARCHAR(2), postal_code VARCHAR(45), country VARCHAR(45), latitude FLOAT(18, 2), longitude FLOAT(18, 2), search_string VARCHAR(255), sequence_order INT, created_at DATETIME, updated_at DATETIME, INDEX idlocation_idx (idlocation), INDEX step_id_idx (step_id), PRIMARY KEY(location_id)) ENGINE = INNODB;
CREATE TABLE messagerecipients (messages_idmessages INT, travelers_idtraveler VARCHAR(45), PRIMARY KEY(messages_idmessages, travelers_idtraveler)) ENGINE = INNODB;
CREATE TABLE messages (id_message INT AUTO_INCREMENT, conversation_id INT, author_id INT NOT NULL, body TEXT NOT NULL, created_at DATETIME, updated_at DATETIME, INDEX idmessages_idx (idmessages), INDEX author_id_idx (author_id), PRIMARY KEY(id_message, conversation_id)) ENGINE = INNODB;
CREATE TABLE negotiation (idnegotiation INT AUTO_INCREMENT, price FLOAT(18, 2), numberofseats INT, date DATE, time TIME, comments TEXT, idseatrequest INT, idnegotiationtype INT NOT NULL, pickuplocation INT NOT NULL, dropofflocation INT NOT NULL, INDEX idnegotiationtype_idx (idnegotiationtype), INDEX pickuplocation_idx (pickuplocation), INDEX dropofflocation_idx (dropofflocation), PRIMARY KEY(idnegotiation, idseatrequest)) ENGINE = INNODB;
CREATE TABLE negotiationtypes (idnegotiationtype INT AUTO_INCREMENT, name VARCHAR(45), isfinal TINYINT, PRIMARY KEY(idnegotiationtype)) ENGINE = INNODB;
CREATE TABLE passengers (passenger_id INT AUTO_INCREMENT, person_id INT NOT NULL, solo_route_id INT NOT NULL, seat_id INT NOT NULL, passenger_count INT, start_date DATE, start_time TIME, asking_price FLOAT(18, 2), description TEXT, created_at DATETIME, updated_at DATETIME, INDEX person_id_idx (person_id), INDEX solo_route_id_idx (solo_route_id), INDEX seat_id_idx (seat_id), PRIMARY KEY(passenger_id)) ENGINE = INNODB;
CREATE TABLE people (person_id INT AUTO_INCREMENT, created_at DATETIME, updated_at DATETIME, PRIMARY KEY(person_id)) ENGINE = INNODB;
CREATE TABLE profiles (profile_name VARCHAR(45), person_id INT NOT NULL, first_name VARCHAR(45), last_name VARCHAR(45), picture_url VARCHAR(255), picture_url_large VARCHAR(255), picture_url_medium VARCHAR(255), picture_url_small VARCHAR(255), picture_url_tiny VARCHAR(255), address_1 VARCHAR(255), address_2 VARCHAR(255), city VARCHAR(45), state VARCHAR(45), postal_code VARCHAR(45), country VARCHAR(45), birthday DATE, gender VARCHAR(45), about_me TEXT, top_5 TEXT, wants_to_travel_to TEXT, music TEXT, movies TEXT, books TEXT, interests TEXT, favorite_websites TEXT, website_url VARCHAR(128), facebook_user_name VARCHAR(45), twitter_user_name VARCHAR(45), created_at DATETIME, updated_at DATETIME, INDEX idprofile_idx (idprofile), INDEX person_id_idx (person_id), PRIMARY KEY(profile_name)) ENGINE = INNODB;
CREATE TABLE reviews (rating_id INT AUTO_INCREMENT, reviewer_id INT NOT NULL, reviewee_id INT NOT NULL, was_safe TINYINT, was_friendly TINYINT, was_punctual TINYINT, was_courteous TINYINT, comments TEXT, driver_review TINYINT, passenger_review TINYINT, created_at DATETIME, updated_at DATETIME, INDEX reviewer_id_idx (reviewer_id), INDEX reviewee_id_idx (reviewee_id), PRIMARY KEY(rating_id)) ENGINE = INNODB;
CREATE TABLE rideofferposts (idrideofferpost INT AUTO_INCREMENT, travelers_idusers VARCHAR(45) NOT NULL, price FLOAT(18, 2), numberofseats INT, date DATE, time TIME, comments TEXT, origin INT NOT NULL, destination INT NOT NULL, vehicles_idvehicle INT, INDEX travelers_idusers_idx (travelers_idusers), INDEX origin_idx (origin), INDEX destination_idx (destination), INDEX vehicles_idvehicle_idx (vehicles_idvehicle), PRIMARY KEY(idrideofferpost)) ENGINE = INNODB;
CREATE TABLE routes (route_id INT AUTO_INCREMENT, copyright VARCHAR(255), summary TEXT, warning TEXT, created_at DATETIME, updated_at DATETIME, PRIMARY KEY(route_id)) ENGINE = INNODB;
CREATE TABLE seat_negotiation_message (seat_negotiation_message_id INT AUTO_INCREMENT, seat_negotiation_id INT NOT NULL, author_id INT NOT NULL, message TEXT, created_at DATETIME, updated_at DATETIME, INDEX seat_negotiation_id_idx (seat_negotiation_id), INDEX author_id_idx (author_id), PRIMARY KEY(seat_negotiation_message_id)) ENGINE = INNODB;
CREATE TABLE seat_negotiation_statuses (seat_negotiation_statuses_id INT AUTO_INCREMENT, display_text VARCHAR(45), created_at DATETIME, updated_at DATETIME, PRIMARY KEY(seat_negotiation_statuses_id)) ENGINE = INNODB;
CREATE TABLE seat_negotiations (seat_negotiation_id INT AUTO_INCREMENT, proposed_route_id INT NOT NULL, seat_negotiation_statuses_id INT NOT NULL, carpool_id INT NOT NULL, passenger_id INT NOT NULL, price FLOAT(18, 2), seat_count INT, pickup_date VARCHAR(45), created_at DATETIME, updated_at DATETIME, pickup_time TIME, INDEX proposed_route_id_idx (proposed_route_id), INDEX seat_negotiation_statuses_id_idx (seat_negotiation_statuses_id), INDEX carpool_id_idx (carpool_id), INDEX passenger_id_idx (passenger_id), PRIMARY KEY(seat_negotiation_id)) ENGINE = INNODB;
CREATE TABLE seatneededposts (idseatneededpost INT AUTO_INCREMENT, travelers_idusers VARCHAR(45) NOT NULL, price FLOAT(18, 2), numberofseats INT, date DATE, time TIME, comments TEXT, pickuplocation INT NOT NULL, dropofflocation INT NOT NULL, INDEX travelers_idusers_idx (travelers_idusers), INDEX pickuplocation_idx (pickuplocation), INDEX dropofflocation_idx (dropofflocation), PRIMARY KEY(idseatneededpost)) ENGINE = INNODB;
CREATE TABLE seatrequests (idseatrequest INT AUTO_INCREMENT, driverid VARCHAR(45) NOT NULL, passengerid VARCHAR(45) NOT NULL, createdon DATETIME, INDEX driverid_idx (driverid), INDEX passengerid_idx (passengerid), PRIMARY KEY(idseatrequest)) ENGINE = INNODB;
CREATE TABLE seats (seat_id INT AUTO_INCREMENT, carpool_id INT NOT NULL, seat_negotiation_id INT NOT NULL, price FLOAT(18, 2), seat_count INT, pickup_date DATE, pickup_time TIME, description TEXT, created_at DATETIME, updated_at DATETIME, INDEX carpool_id_idx (carpool_id), INDEX seat_negotiation_id_idx (seat_negotiation_id), PRIMARY KEY(seat_id)) ENGINE = INNODB;
CREATE TABLE seats_filled_legs (seats_seat_id INT, legs_leg_id INT, created_at DATETIME, updated_at DATETIME, PRIMARY KEY(seats_seat_id, legs_leg_id)) ENGINE = INNODB;
CREATE TABLE security_settings (security_settings_id INT AUTO_INCREMENT, person_id INT NOT NULL, can_email_promotions TINYINT, can_email_partners TINYINT, INDEX person_id_idx (person_id), PRIMARY KEY(security_settings_id)) ENGINE = INNODB;
CREATE TABLE steps (step_id INT AUTO_INCREMENT, leg_id INT NOT NULL, instructions TEXT, distance INT, duration INT, encoded_polyline TEXT, sequence_order INT, created_at DATETIME, updated_at DATETIME, INDEX leg_id_idx (leg_id), PRIMARY KEY(step_id)) ENGINE = INNODB;
CREATE TABLE tags (idtags INT, PRIMARY KEY(idtags)) ENGINE = INNODB;
CREATE TABLE travelers_attending_event (event_id INT AUTO_INCREMENT, person_id INT, status INT NOT NULL, created_at DATETIME, updated_at DATETIME, INDEX status_idx (status), PRIMARY KEY(event_id, person_id)) ENGINE = INNODB;
CREATE TABLE users (user_name VARCHAR(45), person_id INT NOT NULL, email VARCHAR(45) NOT NULL, encrypted_password VARCHAR(128) NOT NULL, INDEX person_id_idx (person_id), PRIMARY KEY(user_name)) ENGINE = INNODB;
CREATE TABLE vehicles (vehicle_id INT AUTO_INCREMENT, person_id INT NOT NULL, seat_count INT, gas_milage FLOAT(18, 2), model_year BIGINT, make VARCHAR(45), model VARCHAR(45), color VARCHAR(45), license_plate VARCHAR(45), baggage_count INT, description TEXT, image_url_large VARCHAR(255), image_url_small VARCHAR(255), created_at DATETIME, updated_at VARCHAR(45), INDEX idvehicle_idx (idvehicle), INDEX person_id_idx (person_id), PRIMARY KEY(vehicle_id)) ENGINE = INNODB;
CREATE TABLE waypoints (rideofferposts_idrideofferpost INT, locations_idlocation INT, sequence INT, PRIMARY KEY(rideofferposts_idrideofferpost, locations_idlocation)) ENGINE = INNODB;
ALTER TABLE carpools ADD CONSTRAINT carpools_vehicle_id_vehicles_vehicle_id FOREIGN KEY (vehicle_id) REFERENCES vehicles(vehicle_id);
ALTER TABLE carpools ADD CONSTRAINT carpools_route_id_routes_route_id FOREIGN KEY (route_id) REFERENCES routes(route_id);
ALTER TABLE comments ADD CONSTRAINT comments_person_id_people_person_id FOREIGN KEY (person_id) REFERENCES people(person_id);
ALTER TABLE comments ADD CONSTRAINT comments_event_id_events_event_id FOREIGN KEY (event_id) REFERENCES events(event_id);
ALTER TABLE conversation_participants ADD CONSTRAINT conversation_participants_person_id_people_person_id FOREIGN KEY (person_id) REFERENCES people(person_id);
ALTER TABLE conversation_participants ADD CONSTRAINT cccc FOREIGN KEY (conversation_id) REFERENCES conversations(conversation_id);
ALTER TABLE conversations ADD CONSTRAINT conversations_author_id_people_person_id FOREIGN KEY (author_id) REFERENCES people(person_id);
ALTER TABLE drivers ADD CONSTRAINT drivers_solo_route_id_routes_route_id FOREIGN KEY (solo_route_id) REFERENCES routes(route_id);
ALTER TABLE drivers ADD CONSTRAINT drivers_person_id_people_person_id FOREIGN KEY (person_id) REFERENCES people(person_id);
ALTER TABLE drivers ADD CONSTRAINT drivers_carpool_id_carpools_carpool_id FOREIGN KEY (carpool_id) REFERENCES carpools(carpool_id);
ALTER TABLE events ADD CONSTRAINT events_location_id_locations_location_id FOREIGN KEY (location_id) REFERENCES locations(location_id);
ALTER TABLE friendship_requests ADD CONSTRAINT friendship_requests_requestor_id_people_person_id FOREIGN KEY (requestor_id) REFERENCES people(person_id);
ALTER TABLE friendship_requests ADD CONSTRAINT friendship_requests_requestee_id_people_person_id FOREIGN KEY (requestee_id) REFERENCES people(person_id);
ALTER TABLE friendship_requests ADD CONSTRAINT ffff FOREIGN KEY (friendship_status_id) REFERENCES friendship_statuses(friendship_status_id);
ALTER TABLE friendships ADD CONSTRAINT friendships_friend_2_id_people_person_id FOREIGN KEY (friend_2_id) REFERENCES people(person_id);
ALTER TABLE friendships ADD CONSTRAINT friendships_friend_1_id_people_person_id FOREIGN KEY (friend_1_id) REFERENCES people(person_id);
ALTER TABLE legs ADD CONSTRAINT legs_route_id_routes_route_id FOREIGN KEY (route_id) REFERENCES routes(route_id);
ALTER TABLE locations ADD CONSTRAINT locations_step_id_steps_step_id FOREIGN KEY (step_id) REFERENCES steps(step_id);
ALTER TABLE messagerecipients ADD CONSTRAINT messagerecipients_travelers_idtraveler_profiles_idprofile FOREIGN KEY (travelers_idtraveler) REFERENCES profiles(idprofile);
ALTER TABLE messagerecipients ADD CONSTRAINT messagerecipients_messages_idmessages_messages_idmessages FOREIGN KEY (messages_idmessages) REFERENCES messages(idmessages);
ALTER TABLE messages ADD CONSTRAINT messages_conversation_id_conversations_conversation_id FOREIGN KEY (conversation_id) REFERENCES conversations(conversation_id);
ALTER TABLE messages ADD CONSTRAINT messages_author_id_people_person_id FOREIGN KEY (author_id) REFERENCES people(person_id);
ALTER TABLE negotiation ADD CONSTRAINT negotiation_pickuplocation_locations_idlocation FOREIGN KEY (pickuplocation) REFERENCES locations(idlocation);
ALTER TABLE negotiation ADD CONSTRAINT negotiation_idseatrequest_seatrequests_idseatrequest FOREIGN KEY (idseatrequest) REFERENCES seatrequests(idseatrequest);
ALTER TABLE negotiation ADD CONSTRAINT negotiation_idnegotiationtype_negotiationtypes_idnegotiationtype FOREIGN KEY (idnegotiationtype) REFERENCES negotiationtypes(idnegotiationtype);
ALTER TABLE negotiation ADD CONSTRAINT negotiation_dropofflocation_locations_idlocation FOREIGN KEY (dropofflocation) REFERENCES locations(idlocation);
ALTER TABLE passengers ADD CONSTRAINT passengers_solo_route_id_routes_route_id FOREIGN KEY (solo_route_id) REFERENCES routes(route_id);
ALTER TABLE passengers ADD CONSTRAINT passengers_seat_id_seats_seat_id FOREIGN KEY (seat_id) REFERENCES seats(seat_id);
ALTER TABLE passengers ADD CONSTRAINT passengers_person_id_people_person_id FOREIGN KEY (person_id) REFERENCES people(person_id);
ALTER TABLE profiles ADD CONSTRAINT profiles_person_id_people_person_id FOREIGN KEY (person_id) REFERENCES people(person_id);
ALTER TABLE reviews ADD CONSTRAINT reviews_reviewer_id_people_person_id FOREIGN KEY (reviewer_id) REFERENCES people(person_id);
ALTER TABLE reviews ADD CONSTRAINT reviews_reviewee_id_people_person_id FOREIGN KEY (reviewee_id) REFERENCES people(person_id);
ALTER TABLE rideofferposts ADD CONSTRAINT rideofferposts_vehicles_idvehicle_vehicles_idvehicle FOREIGN KEY (vehicles_idvehicle) REFERENCES vehicles(idvehicle);
ALTER TABLE rideofferposts ADD CONSTRAINT rideofferposts_travelers_idusers_profiles_idprofile FOREIGN KEY (travelers_idusers) REFERENCES profiles(idprofile);
ALTER TABLE rideofferposts ADD CONSTRAINT rideofferposts_origin_locations_idlocation FOREIGN KEY (origin) REFERENCES locations(idlocation);
ALTER TABLE rideofferposts ADD CONSTRAINT rideofferposts_destination_locations_idlocation FOREIGN KEY (destination) REFERENCES locations(idlocation);
ALTER TABLE seat_negotiation_message ADD CONSTRAINT ssss FOREIGN KEY (seat_negotiation_id) REFERENCES seat_negotiations(seat_negotiation_id);
ALTER TABLE seat_negotiation_message ADD CONSTRAINT seat_negotiation_message_author_id_people_person_id FOREIGN KEY (author_id) REFERENCES people(person_id);
ALTER TABLE seat_negotiations ADD CONSTRAINT ssss_2 FOREIGN KEY (seat_negotiation_statuses_id) REFERENCES seat_negotiation_statuses(seat_negotiation_statuses_id);
ALTER TABLE seat_negotiations ADD CONSTRAINT seat_negotiations_proposed_route_id_routes_route_id FOREIGN KEY (proposed_route_id) REFERENCES routes(route_id);
ALTER TABLE seat_negotiations ADD CONSTRAINT seat_negotiations_passenger_id_passengers_passenger_id FOREIGN KEY (passenger_id) REFERENCES passengers(passenger_id);
ALTER TABLE seat_negotiations ADD CONSTRAINT seat_negotiations_carpool_id_carpools_carpool_id FOREIGN KEY (carpool_id) REFERENCES carpools(carpool_id);
ALTER TABLE seatneededposts ADD CONSTRAINT seatneededposts_travelers_idusers_profiles_idprofile FOREIGN KEY (travelers_idusers) REFERENCES profiles(idprofile);
ALTER TABLE seatneededposts ADD CONSTRAINT seatneededposts_pickuplocation_locations_idlocation FOREIGN KEY (pickuplocation) REFERENCES locations(idlocation);
ALTER TABLE seatneededposts ADD CONSTRAINT seatneededposts_dropofflocation_locations_idlocation FOREIGN KEY (dropofflocation) REFERENCES locations(idlocation);
ALTER TABLE seatrequests ADD CONSTRAINT seatrequests_passengerid_profiles_idprofile FOREIGN KEY (passengerid) REFERENCES profiles(idprofile);
ALTER TABLE seatrequests ADD CONSTRAINT seatrequests_driverid_profiles_idprofile FOREIGN KEY (driverid) REFERENCES profiles(idprofile);
ALTER TABLE seats ADD CONSTRAINT seats_seat_negotiation_id_seat_negotiations_seat_negotiation_id FOREIGN KEY (seat_negotiation_id) REFERENCES seat_negotiations(seat_negotiation_id);
ALTER TABLE seats ADD CONSTRAINT seats_carpool_id_carpools_carpool_id FOREIGN KEY (carpool_id) REFERENCES carpools(carpool_id);
ALTER TABLE seats_filled_legs ADD CONSTRAINT seats_filled_legs_seats_seat_id_seats_seat_id FOREIGN KEY (seats_seat_id) REFERENCES seats(seat_id);
ALTER TABLE seats_filled_legs ADD CONSTRAINT seats_filled_legs_legs_leg_id_legs_leg_id FOREIGN KEY (legs_leg_id) REFERENCES legs(leg_id);
ALTER TABLE security_settings ADD CONSTRAINT security_settings_person_id_people_person_id FOREIGN KEY (person_id) REFERENCES people(person_id);
ALTER TABLE steps ADD CONSTRAINT steps_leg_id_legs_leg_id FOREIGN KEY (leg_id) REFERENCES legs(leg_id);
ALTER TABLE travelers_attending_event ADD CONSTRAINT tsaa FOREIGN KEY (status) REFERENCES attending_status_type(attending_status_type_id);
ALTER TABLE travelers_attending_event ADD CONSTRAINT travelers_attending_event_person_id_people_person_id FOREIGN KEY (person_id) REFERENCES people(person_id);
ALTER TABLE travelers_attending_event ADD CONSTRAINT travelers_attending_event_event_id_events_event_id FOREIGN KEY (event_id) REFERENCES events(event_id);
ALTER TABLE users ADD CONSTRAINT users_person_id_people_person_id FOREIGN KEY (person_id) REFERENCES people(person_id);
ALTER TABLE vehicles ADD CONSTRAINT vehicles_person_id_people_person_id FOREIGN KEY (person_id) REFERENCES people(person_id);
ALTER TABLE waypoints ADD CONSTRAINT wrri FOREIGN KEY (rideofferposts_idrideofferpost) REFERENCES rideofferposts(idrideofferpost);
ALTER TABLE waypoints ADD CONSTRAINT waypoints_locations_idlocation_locations_idlocation FOREIGN KEY (locations_idlocation) REFERENCES locations(idlocation);
